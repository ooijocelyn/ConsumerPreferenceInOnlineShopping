<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consumer Purchase Decision Research Study</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .section {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        input[type="text"], input[type="number"], select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus, input[type="number"]:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #4facfe;
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            padding: 15px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .radio-option:hover {
            border-color: #4facfe;
            background-color: #f8f9ff;
        }

        .radio-option input[type="radio"] {
            margin-right: 12px;
            transform: scale(1.2);
        }

        .btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            margin-right: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(79, 172, 254, 0.3);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-secondary:hover {
            box-shadow: 0 10px 20px rgba(108, 117, 125, 0.3);
        }

        .consent-text {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            border-left: 5px solid #4facfe;
            margin-bottom: 25px;
            max-height: 400px;
            overflow-y: auto;
        }

        .consent-text h3 {
            color: #4facfe;
            margin-bottom: 15px;
        }

        .consent-text p {
            margin-bottom: 15px;
        }

        .scenario-box {
            background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%);
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .scale-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .scale-options {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .scale-option-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .scale-options input[type="radio"] {
            transform: scale(1.3);
        }

        .scale-number {
            font-size: 12px;
            color: #666;
            font-weight: 500;
        }

        .error {
            color: #dc3545;
            font-size: 14px;
            margin-top: 5px;
        }

        .progress-bar {
            height: 4px;
            background: #e1e5e9;
            border-radius: 2px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            transition: width 0.3s ease;
            border-radius: 2px;
        }

        .thank-you {
            text-align: center;
            padding: 40px 20px;
        }

        .thank-you h2 {
            color: #4facfe;
            margin-bottom: 20px;
            font-size: 2.5em;
        }

        .thank-you p {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 15px;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #4facfe;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Consumer Purchase Decision Research Study</h1>
            <p>HELP University - Department of Psychology</p>
        </div>

        <div class="content">
            <!-- Progress Bar -->
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
            </div>

            <!-- Welcome Section -->
            <div class="section active" id="welcome">
                <h2>Welcome to Our Research Study</h2>
                <p>This study explores how certainty versus uncertainty in product information influences consumer purchase decisions in young adults.</p>
                <br>
                <p><strong>Time Required:</strong> Approximately 10-15 minutes</p>
                <p><strong>Participants:</strong> Adults aged 18-29 years</p>
                <br>
                <button class="btn" onclick="nextSection('consent')">Begin Study</button>
            </div>

            <!-- Informed Consent Section -->
            <div class="section" id="consent">
                <h2>Informed Consent</h2>
                <div class="consent-text">
                    <p><strong>Dear participants,</strong></p>
                    <p>This study explores how certainty versus uncertainty in product information influences consumer purchase decisions in young adults. To participate in this study, you must:</p>
                    <ol>
                        <li>Be aged between 18-29 years old, and</li>
                        <li>Be able to read and understand English instructions</li>
                    </ol>
                    
                    <h3>What will be done:</h3>
                    <p>If you choose to take part in this research, you will first be asked to read and agree to an informed consent form. After that, you will be required to provide some demographic information. Then, you will be presented with a short scenario involving a purchasing situation followed by a Purchase Intention Scale (Bagozzi, 2016) to measure your intention to purchase. The entire process is expected to take no more than 15 minutes.</p>
                    
                    <h3>Risks and discomfort:</h3>
                    <p>There are no anticipated risks or discomfort in participation in the current study. However, if you experience any discomfort while participating in this study, you are free to terminate your participation at any time, and you will not be penalised. If you find your participation in the study has caused you psychological harm, you may contact the Centre of Psychological and Counselling Services (CPCS) at https://www.cpcs-helpuni.com/ (03-78493200) or any reputable counselling centres near you. Please note that the CPCS only sees clients on an appointment basis.</p>
                    
                    <h3>Confidentiality:</h3>
                    <p>Your responses will remain anonymous throughout the study. The information and data collected will only be assessed by the researchers and the researchers' supervisor.</p>
                    
                    <h3>Decision to quit at any time:</h3>
                    <p>Participation in this study is voluntary, you may withdraw at any time. No adverse action will be taken against you for withdrawing your participation. If you wish to quit the study, you may exit without submitting the current informed consent form.</p>
                    
                    <h3>Benefits of this study:</h3>
                    <p>While there are no direct benefits for participating in this study, your participation will contribute valuable insights to the field of psychology and consumer behavior. The findings may help researchers better understand how different types of rewards influence purchasing intention.</p>
                    
                    <p>This study has been reviewed and approved by the Ethics Review Board, Department of Psychology, Faculty of Behavioural Sciences at HELP University [ERB Approval Code: < >].</p>
                    
                    <p><strong>For any research-related problems, complaints, or questions regarding participants' rights, please contact:</strong><br>
                    Chairperson, Ethics Review Board<br>
                    Department of Psychology Faculty of Behavioural Sciences<br>
                    Level 3, Block B HELP University – Subang 2<br>
                    Persiaran Cakerawala, Seksyen U4<br>
                    40150 Shah Alam Selangor Darul Ehsan Malaysia<br>
                    Email: psych.erb@help.edu.my<br>
                    Phone: +603 7849 3000</p>
                    
                    <p><strong>For any enquiries of this particular study, please contact:</strong><br>
                    <strong>Researcher:</strong> Jocelyn Ooi Si Hua - B2100842@helplive.edu.my<br>
                    <strong>Researcher's Supervisor:</strong> Khor Khai Ling - khailing.k@help.edu.my</p>
                </div>

                <div class="form-group">
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="consent_yes" name="consent" value="yes">
                            <label for="consent_yes">Yes, I understand and agree to participate in this study.</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="consent_no" name="consent" value="no">
                            <label for="consent_no">No, I would not like to participate in this study.</label>
                        </div>
                    </div>
                </div>
                <button class="btn" onclick="processConsent()">Continue</button>
            </div>

            <!-- Eligibility Check -->
            <div class="section" id="eligibility">
                <h2>Eligibility Check</h2>
                <div class="form-group">
                    <label>Are you between 18-29 years old?</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="age_yes" name="age_eligible" value="yes">
                            <label for="age_yes">Yes</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="age_no" name="age_eligible" value="no">
                            <label for="age_no">No</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Are you able to read and understand English instructions?</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="english_yes" name="english_proficiency" value="yes">
                            <label for="english_yes">Yes</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="english_no" name="english_proficiency" value="no">
                            <label for="english_no">No</label>
                        </div>
                    </div>
                </div>
                <button class="btn" onclick="checkEligibility()">Continue</button>
            </div>

            <!-- Demographics -->
            <div class="section" id="demographics">
                <h2>Demographic Information</h2>
                <div class="form-group">
                    <label for="age">Age:</label>
                    <input type="number" id="age" name="age" min="18" max="29" required>
                </div>

                <div class="form-group">
                    <label for="gender">Gender:</label>
                    <select id="gender" name="gender" required>
                        <option value="">Select Gender</option>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                        <option value="prefer-not-to-say">Prefer not to say</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Have you previously purchased a blind box/mystery products before? <em>(*Products where you don't know the specific item until after purchase)</em></label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="exp_yes" name="mystery_experience" value="yes">
                            <label for="exp_yes">Yes</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="exp_no" name="mystery_experience" value="no">
                            <label for="exp_no">No</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>In the past 6 months, how many blind box/mystery products have you purchased? <em>(*Products where you don't know the specific item until after purchase)</em></label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="freq_0" name="purchase_frequency" value="0">
                            <label for="freq_0">0 (none in the past six months)</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="freq_1-2" name="purchase_frequency" value="1-2">
                            <label for="freq_1-2">1-2</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="freq_3-5" name="purchase_frequency" value="3-5">
                            <label for="freq_3-5">3-5</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="freq_6-10" name="purchase_frequency" value="6-10">
                            <label for="freq_6-10">6-10</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="freq_more" name="purchase_frequency" value="more than 10">
                            <label for="freq_more">More than 10</label>
                        </div>
                    </div>
                </div>
                <button class="btn" onclick="validateDemographics()">Continue</button>
            </div>

            <!-- Scenario Presentation -->
            <div class="section" id="scenario">
                <h2>Purchase Scenario</h2>
                <div class="scenario-box" id="scenarioContent">
                    <!-- Scenario content will be inserted here based on condition -->
                </div>
                <button class="btn" onclick="nextSection('purchase-intention')">Continue</button>
            </div>

            <!-- Purchase Intention Scale -->
            <div class="section" id="purchase-intention">
                <h2>Purchase Intention Scale (Bagozzi et al., 2016)</h2>
                <p><strong>Based on the situation above, please indicate your agreement with the following statements:</strong></p>

                <div class="form-group">
                    <div class="scale-item">
                        <span><strong>I would feel a strong urge to buy the product.</strong></span>
                        <div class="scale-options">
                            <label style="margin-right: 5px; font-size: 12px;">Strongly Disagree</label>
                            <div class="scale-option-container">
                                <input type="radio" name="urge_buy" value="1">
                                <span class="scale-number">1</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="urge_buy" value="2">
                                <span class="scale-number">2</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="urge_buy" value="3">
                                <span class="scale-number">3</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="urge_buy" value="4">
                                <span class="scale-number">4</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="urge_buy" value="5">
                                <span class="scale-number">5</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="urge_buy" value="6">
                                <span class="scale-number">6</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="urge_buy" value="7">
                                <span class="scale-number">7</span>
                            </div>
                            <label style="margin-left: 5px; font-size: 12px;">Strongly Agree</label>
                        </div>
                    </div>

                    <div class="scale-item">
                        <span><strong>I would want to purchase the product.</strong></span>
                        <div class="scale-options">
                            <label style="margin-right: 5px; font-size: 12px;">Strongly Disagree</label>
                            <div class="scale-option-container">
                                <input type="radio" name="want_purchase" value="1">
                                <span class="scale-number">1</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="want_purchase" value="2">
                                <span class="scale-number">2</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="want_purchase" value="3">
                                <span class="scale-number">3</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="want_purchase" value="4">
                                <span class="scale-number">4</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="want_purchase" value="5">
                                <span class="scale-number">5</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="want_purchase" value="6">
                                <span class="scale-number">6</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="want_purchase" value="7">
                                <span class="scale-number">7</span>
                            </div>
                            <label style="margin-left: 5px; font-size: 12px;">Strongly Agree</label>
                        </div>
                    </div>

                    <div class="scale-item">
                        <span><strong>I would feel the impulse to buy the product.</strong></span>
                        <div class="scale-options">
                            <label style="margin-right: 5px; font-size: 12px;">Strongly Disagree</label>
                            <div class="scale-option-container">
                                <input type="radio" name="impulse_buy" value="1">
                                <span class="scale-number">1</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="impulse_buy" value="2">
                                <span class="scale-number">2</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="impulse_buy" value="3">
                                <span class="scale-number">3</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="impulse_buy" value="4">
                                <span class="scale-number">4</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="impulse_buy" value="5">
                                <span class="scale-number">5</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="impulse_buy" value="6">
                                <span class="scale-number">6</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="impulse_buy" value="7">
                                <span class="scale-number">7</span>
                            </div>
                            <label style="margin-left: 5px; font-size: 12px;">Strongly Agree</label>
                        </div>
                    </div>

                    <div class="scale-item">
                        <span><strong>Please indicate the probability that you would buy the product.</strong></span>
                        <div class="scale-options">
                            <label style="margin-right: 5px; font-size: 12px;">Very Unlikely</label>
                            <div class="scale-option-container">
                                <input type="radio" name="probability_buy" value="1">
                                <span class="scale-number">1</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="probability_buy" value="2">
                                <span class="scale-number">2</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="probability_buy" value="3">
                                <span class="scale-number">3</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="probability_buy" value="4">
                                <span class="scale-number">4</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="probability_buy" value="5">
                                <span class="scale-number">5</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="probability_buy" value="6">
                                <span class="scale-number">6</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="probability_buy" value="7">
                                <span class="scale-number">7</span>
                            </div>
                            <label style="margin-left: 5px; font-size: 12px;">Very Likely</label>
                        </div>
                    </div>
                </div>
                <button class="btn" id="submitBtn" onclick="validatePurchaseIntention()">Submit Responses</button>
            </div>

            <!-- Thank You Page -->
            <div class="section" id="thankyou">
                <div class="thank-you">
                    <h2>Thank You!</h2>
                    <p>Your participation in this research study is greatly appreciated.</p>
                    <p>Your responses have been recorded and will contribute valuable insights to our understanding of consumer purchase decisions.</p>
                    <p>If you have any questions about this study, please contact the researchers using the information provided in the consent form.</p>
                    <br>
                    <p><em>You may now close this browser window.</em></p>
                </div>
            </div>

            <!-- Ineligible Page -->
            <div class="section" id="ineligible">
                <div class="thank-you">
                    <h2>Thank You for Your Interest</h2>
                    <p>Unfortunately, you do not meet the eligibility criteria for this study.</p>
                    <p>We appreciate your willingness to participate in research.</p>
                    <br>
                    <p><em>You may now close this browser window.</em></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        const totalSteps = 6;
        let condition = null;
        let responses = {};

        // Your Google Apps Script URL - Data will save to Google Sheets
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwlBU2O_yrt90dGeXAiVL4AJvpUgSzYf9RIqf85WhXEuO8-3We_xOVc4Qz1RyXvnFwO/exec';

        // Scenarios for different conditions
        const scenarios = {
            uncertainty: {
                title: "Experimental Scenario",
                content: "Imagine the following situation:<br><br>You come across a Labubu 'Have A Seat' collectible priced at RM70. This is sold in a mystery box format, you can see the possible characters (as shown), but you won't know which specific one you'll receive until after purchase. Some versions are valued higher than others.",
                image: `
                    <div style="text-align: center; margin: 20px 0;">
                        <img src="https://i.imgur.com/placeholder-labubu-box.jpg" 
                             style="width: 300px; height: auto; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);"
                             alt="Labubu Have A Seat Mystery Box showing possible characters">
                        <div style="margin-top: 15px;">
                            <div style="font-size: 18px; color: #667eea; font-weight: bold;">🎁 Labubu 'Have A Seat' Mystery Box</div>
                            <div style="font-size: 14px; color: #666; margin: 5px 0;">Collectible series by Pop Mart - you'll receive one random character from the series</div>
                            <div style="font-size: 24px; color: #e74c3c; font-weight: bold;">RM 70</div>
                        </div>
                    </div>
                `
            },
            certainty: {
                title: "Experimental Scenario", 
                content: "Imagine the following situation:<br><br>You come across a Labubu 'Have A Seat' collectible priced at RM70. The product clearly shows the exact item you will receive - the BABA character from this series (as shown in the image). Labubu are popular collectible figures by Pop Mart featuring cute, rabbit-like characters that are very popular among young adults. You know exactly which specific character you will get.",
                image: `
                    <div style="text-align: center; margin: 20px 0;">
                        <img src="data:image/jpeg;base64,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" 
                             style="width: 250px; height: auto; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);"
                             alt="Labubu BABA character - brown rabbit-like figure">
                        <div style="margin-top: 15px;">
                            <div style="font-size: 18px; color: #667eea; font-weight: bold;">🐰 Labubu 'Have A Seat' - BABA Character</div>
                            <div style="font-size: 14px; color: #666; margin: 5px 0;">Specific character from the collectible series by Pop Mart</div>
                            <div style="font-size: 24px; color: #e74c3c; font-weight: bold;">RM 70</div>
                        </div>
                    </div>
                `
            }
        };

        function updateProgress() {
            const progress = (currentStep / totalSteps) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function nextSection(sectionId) {
            // Hide current section
            document.querySelector('.section.active').classList.remove('active');
            
            // Show next section  
            document.getElementById(sectionId).classList.add('active');
            
            currentStep++;
            updateProgress();

            // Random assignment when moving to scenario
            if (sectionId === 'scenario' && condition === null) {
                // Equal randomization: 50% uncertainty, 50% certainty
                condition = Math.random() < 0.5 ? 'uncertainty' : 'certainty';
                responses.condition = condition;
                
                const scenario = scenarios[condition];
                document.getElementById('scenarioContent').innerHTML = `
                    <h3>${scenario.title}</h3>
                    <p>${scenario.content}</p>
                    ${scenario.image}
                `;
            }
        }

        function processConsent() {
            const consent = document.querySelector('input[name="consent"]:checked');
            if (!consent) {
                alert('Please select an option to continue.');
                return;
            }

            if (consent.value === 'no') {
                nextSection('thankyou');
                return;
            }

            responses.consent = consent.value;
            nextSection('eligibility');
        }

        function checkEligibility() {
            const ageEligible = document.querySelector('input[name="age_eligible"]:checked');
            const englishProficiency = document.querySelector('input[name="english_proficiency"]:checked');

            if (!ageEligible || !englishProficiency) {
                alert('Please answer all eligibility questions.');
                return;
            }

            responses.age_eligible = ageEligible.value;
            responses.english_proficiency = englishProficiency.value;

            if (ageEligible.value === 'no' || englishProficiency.value === 'no') {
                nextSection('ineligible');
                return;
            }

            nextSection('demographics');
        }

        function validateDemographics() {
            const age = document.getElementById('age').value;
            const gender = document.getElementById('gender').value;
            const experience = document.querySelector('input[name="mystery_experience"]:checked');
            const frequency = document.querySelector('input[name="purchase_frequency"]:checked');

            if (!age || !gender || !experience || !frequency) {
                alert('Please fill in all demographic information.');
                return;
            }

            if (age < 18 || age > 29) {
                alert('Age must be between 18-29 years.');
                return;
            }

            responses.age = age;
            responses.gender = gender;
            responses.mystery_experience = experience.value;
            responses.purchase_frequency = frequency.value;

            nextSection('scenario');
        }

        async function validatePurchaseIntention() {
            const urgeBuy = document.querySelector('input[name="urge_buy"]:checked');
            const wantPurchase = document.querySelector('input[name="want_purchase"]:checked');
            const impulseBuy = document.querySelector('input[name="impulse_buy"]:checked');
            const probabilityBuy = document.querySelector('input[name="probability_buy"]:checked');

            if (!urgeBuy || !wantPurchase || !impulseBuy || !probabilityBuy) {
                alert('Please answer all questions before submitting.');
                return;
            }

            responses.urge_buy = urgeBuy.value;
            responses.want_purchase = wantPurchase.value;
            responses.impulse_buy = impulseBuy.value;
            responses.probability_buy = probabilityBuy.value;
            responses.timestamp = new Date().toISOString();

            // Show loading state
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.innerHTML = 'Saving to Google Sheets...<div class="loading"></div>';

            try {
                // Send data to Google Sheets
                await submitToGoogleSheets(responses);
                console.log('Data successfully saved to Google Sheets:', responses);
                nextSection('thankyou');
            } catch (error) {
                console.error('Google Sheets submission error:', error);
                alert('Data saved locally but could not sync to Google Sheets. Please contact the researcher.');
                // Still proceed to thank you page
                nextSection('thankyou');
            }
        }

        async function submitToGoogleSheets(data) {
            // Check if Google Apps Script URL is configured
            if (GOOGLE_SCRIPT_URL.includes('YOUR_SCRIPT_ID_HERE')) {
                console.log('Google Sheets not configured. Data saved locally:', data);
                return;
            }

            // Prepare data for Google Sheets
            const formData = new FormData();
            formData.append('timestamp', new Date().toISOString());
            formData.append('condition', data.condition || '');
            formData.append('consent', data.consent || '');
            formData.append('age_eligible', data.age_eligible || '');
            formData.append('english_proficiency', data.english_proficiency || '');
            formData.append('age', data.age || '');
            formData.append('gender', data.gender || '');
            formData.append('mystery_experience', data.mystery_experience || '');
            formData.append('purchase_frequency', data.purchase_frequency || '');
            formData.append('urge_buy', data.urge_buy || '');
            formData.append('want_purchase', data.want_purchase || '');
            formData.append('impulse_buy', data.impulse_buy || '');
            formData.append('probability_buy', data.probability_buy || '');

            const response = await fetch(GOOGLE_SCRIPT_URL, {
                method: 'POST',
                body: formData
            });

            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            return response.text();
        }

        // Initialize progress bar
        updateProgress();
    </script>
</body>
</html>