<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consumer Purchase Decision Research Study</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .section {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        input[type="text"], input[type="number"], select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus, input[type="number"]:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #4facfe;
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            padding: 15px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .radio-option:hover {
            border-color: #4facfe;
            background-color: #f8f9ff;
        }

        .radio-option input[type="radio"] {
            margin-right: 12px;
            transform: scale(1.2);
        }

        .btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            margin-right: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(79, 172, 254, 0.3);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-secondary:hover {
            box-shadow: 0 10px 20px rgba(108, 117, 125, 0.3);
        }

        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        /* Force mobile scale layout with higher specificity */
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 10px;
            }
            
            .content {
                padding: 20px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 1.5em;
            }
            
            /* Make images responsive on mobile */
            .scenario-box img {
                max-width: 100% !important;
                width: auto !important;
                height: auto !important;
            }
            
            /* FORCE mobile scale layout */
            .form-group .scale-item {
                display: flex !important;
                flex-direction: column !important;
                align-items: stretch !important;
                justify-content: flex-start !important;
                padding: 20px 15px !important;
                gap: 0 !important;
            }
            
            .form-group .scale-item span {
                text-align: center !important;
                font-size: 16px !important;
                line-height: 1.4 !important;
                margin-bottom: 15px !important;
                display: block !important;
            }
            
            /* Mobile scale labels - FORCE positioning */
            .form-group .scale-labels {
                display: flex !important;
                justify-content: space-between !important;
                margin: 15px 0 10px 0 !important;
                width: 100% !important;
            }
            
            .form-group .scale-label-left, 
            .form-group .scale-label-right {
                font-size: 13px !important;
                font-weight: bold !important;
                color: #333 !important;
                display: block !important;
            }
            
            /* FORCE grid layout on mobile */
            .form-group .scale-options {
                display: grid !important;
                grid-template-columns: repeat(7, 1fr) !important;
                gap: 8px !important;
                margin: 10px 0 !important;
                justify-content: stretch !important;
                align-items: stretch !important;
            }
            
            .form-group .scale-option-container {
                display: flex !important;
                flex-direction: column !important;
                align-items: center !important;
                gap: 8px !important;
                padding: 12px 3px !important;
            }
            
            .form-group .scale-options input[type="radio"] {
                transform: scale(1.6) !important;
                margin: 0 !important;
            }
            
            .form-group .scale-number {
                font-size: 14px !important;
                font-weight: bold !important;
                color: #333 !important;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                margin-right: 0;
                margin-bottom: 10px;
            }
        }

        .consent-text {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            border-left: 5px solid #4facfe;
            margin-bottom: 25px;
            max-height: 400px;
            overflow-y: auto;
        }

        .consent-text h3 {
            color: #4facfe;
            margin-bottom: 15px;
        }

        .consent-text p {
            margin-bottom: 15px;
        }

        .scenario-box {
            background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%);
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .scale-item {
            display: flex;
            flex-direction: column;
            align-items: stretch;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .scale-item span {
            text-align: left;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .scale-labels {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .scale-label-left, .scale-label-right {
            font-size: 12px;
            color: #666;
            font-weight: 500;
        }

        .scale-options {
            display: flex;
            justify-content: center;
            gap: 10px;
            align-items: center;
        }

        .scale-option-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .scale-options input[type="radio"] {
            transform: scale(1.3);
        }

        .scale-number {
            font-size: 12px;
            color: #666;
            font-weight: 500;
        }

        .error {
            color: #dc3545;
            font-size: 14px;
            margin-top: 5px;
        }

        .progress-bar {
            height: 4px;
            background: #e1e5e9;
            border-radius: 2px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            transition: width 0.3s ease;
            border-radius: 2px;
        }

        .thank-you {
            text-align: center;
            padding: 40px 20px;
        }

        .thank-you h2 {
            color: #4facfe;
            margin-bottom: 20px;
            font-size: 2.5em;
        }

        .thank-you p {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 15px;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #4facfe;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Consumer Purchase Decision Research Study</h1>
            <p>HELP University - Department of Psychology</p>
        </div>

        <div class="content">
            <!-- Progress Bar -->
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
            </div>

            <!-- Welcome Section -->
            <div class="section active" id="welcome">
                <h2>Welcome to Our Research Study</h2>
                <p>This study explores how certainty versus uncertainty in product information influences consumer purchase decisions in young adults.</p>
                <br>
                <p><strong>Time Required:</strong> Approximately 10-15 minutes</p>
                <p><strong>Participants:</strong> Adults aged 18-29 years</p>
                <br>
                <button class="btn" onclick="nextSection('consent')">Begin Study</button>
            </div>

            <!-- Informed Consent Section -->
            <div class="section" id="consent">
                <h2>Informed Consent</h2>
                <div class="consent-text">
                    <p><strong>Dear participants,</strong></p>
                    <p>This study explores how certainty versus uncertainty in product information influences consumer purchase decisions in young adults. To participate in this study, you must:</p>
                    <ol>
                        <li>Be aged between 18-29 years old, and</li>
                        <li>Be able to read and understand English instructions</li>
                    </ol>
                    
                    <h3>What will be done:</h3>
                    <p>If you choose to take part in this research, you will first be asked to read and agree to an informed consent form. After that, you will be required to provide some demographic information. Then, you will be presented with a short scenario involving a purchasing situation followed by a Purchase Intention Scale (Bagozzi, 2016) to measure your intention to purchase. The entire process is expected to take no more than 15 minutes.</p>
                    
                    <h3>Risks and discomfort:</h3>
                    <p>There are no anticipated risks or discomfort in participation in the current study. However, if you experience any discomfort while participating in this study, you are free to terminate your participation at any time, and you will not be penalised. If you find your participation in the study has caused you psychological harm, you may contact the Centre of Psychological and Counselling Services (CPCS) at https://www.cpcs-helpuni.com/ (03-78493200) or any reputable counselling centres near you. Please note that the CPCS only sees clients on an appointment basis.</p>
                    
                    <h3>Confidentiality:</h3>
                    <p>Your responses will remain anonymous throughout the study. The information and data collected will only be assessed by the researchers and the researchers' supervisor.</p>
                    
                    <h3>Decision to quit at any time:</h3>
                    <p>Participation in this study is voluntary, you may withdraw at any time. No adverse action will be taken against you for withdrawing your participation. If you wish to quit the study, you may exit without submitting the current informed consent form.</p>
                    
                    <h3>Benefits of this study:</h3>
                    <p>While there are no direct benefits for participating in this study, your participation will contribute valuable insights to the field of psychology and consumer behavior. The findings may help researchers better understand how different types of rewards influence purchasing intention.</p>
                    
                    <p>This study has been reviewed and approved by the Ethics Review Board, Department of Psychology, Faculty of Behavioural Sciences at HELP University [ERB Approval Code: < >].</p>
                    
                    <p><strong>For any research-related problems, complaints, or questions regarding participants' rights, please contact:</strong><br>
                    Chairperson, Ethics Review Board<br>
                    Department of Psychology Faculty of Behavioural Sciences<br>
                    Level 3, Block B HELP University – Subang 2<br>
                    Persiaran Cakerawala, Seksyen U4<br>
                    40150 Shah Alam Selangor Darul Ehsan Malaysia<br>
                    Email: psych.erb@help.edu.my<br>
                    Phone: +603 7849 3000</p>
                    
                    <p><strong>For any enquiries of this particular study, please contact:</strong><br>
                    <strong>Researcher:</strong> Jocelyn Ooi Si Hua - B2100842@helplive.edu.my<br>
                    <strong>Researcher's Supervisor:</strong> Khor Khai Ling - khailing.k@help.edu.my</p>
                </div>

                <div class="form-group">
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="consent_yes" name="consent" value="yes">
                            <label for="consent_yes">Yes, I understand and agree to participate in this study.</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="consent_no" name="consent" value="no">
                            <label for="consent_no">No, I would not like to participate in this study.</label>
                        </div>
                    </div>
                </div>
                <div class="button-group">
                    <button class="btn" onclick="processConsent()">Continue</button>
                </div>
            </div>

            <!-- Eligibility Check -->
            <div class="section" id="eligibility">
                <h2>Eligibility Check</h2>
                <div class="form-group">
                    <label>Are you between 18-29 years old?</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="age_yes" name="age_eligible" value="yes">
                            <label for="age_yes">Yes</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="age_no" name="age_eligible" value="no">
                            <label for="age_no">No</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Are you able to read and understand English instructions?</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="english_yes" name="english_proficiency" value="yes">
                            <label for="english_yes">Yes</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="english_no" name="english_proficiency" value="no">
                            <label for="english_no">No</label>
                        </div>
                    </div>
                </div>
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="goBack('consent')">Back</button>
                    <button class="btn" onclick="checkEligibility()">Continue</button>
                </div>
            </div>

            <!-- Demographics -->
            <div class="section" id="demographics">
                <h2>Demographic Information</h2>
                <div class="form-group">
                    <label for="age">Age:</label>
                    <input type="number" id="age" name="age" min="18" max="29" required>
                </div>

                <div class="form-group">
                    <label for="gender">Gender:</label>
                    <select id="gender" name="gender" required>
                        <option value="">Select Gender</option>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                        <option value="prefer-not-to-say">Prefer not to say</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Have you previously purchased a blind box/mystery products before? <em>(*Products where you don't know the specific item until after purchase)</em></label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="exp_yes" name="mystery_experience" value="yes">
                            <label for="exp_yes">Yes</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="exp_no" name="mystery_experience" value="no">
                            <label for="exp_no">No</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>In the past 6 months, how many blind box/mystery products have you purchased? <em>(*Products where you don't know the specific item until after purchase)</em></label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="freq_0" name="purchase_frequency" value="0">
                            <label for="freq_0">0 (none in the past six months)</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="freq_1-2" name="purchase_frequency" value="1-2">
                            <label for="freq_1-2">1-2</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="freq_3-5" name="purchase_frequency" value="3-5">
                            <label for="freq_3-5">3-5</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="freq_6-10" name="purchase_frequency" value="6-10">
                            <label for="freq_6-10">6-10</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="freq_more" name="purchase_frequency" value="more than 10">
                            <label for="freq_more">More than 10</label>
                        </div>
                    </div>
                </div>
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="goBack('eligibility')">Back</button>
                    <button class="btn" onclick="validateDemographics()">Continue</button>
                </div>
            </div>

            <!-- Scenario Presentation -->
            <div class="section" id="scenario">
                <h2>Purchase Scenario</h2>
                <div class="scenario-box" id="scenarioContent">
                    <!-- Scenario content will be inserted here based on condition -->
                </div>
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="goBack('demographics')">Back</button>
                    <button class="btn" onclick="nextSection('purchase-intention')">Continue</button>
                </div>
            </div>

            <!-- Purchase Intention Scale -->
            <div class="section" id="purchase-intention">
                <h2>Purchase Intention Scale (Bagozzi et al., 2016)</h2>
                <p><strong>Based on the situation above, please indicate your agreement with the following statements:</strong></p>

                <div class="form-group">
                    <div class="scale-item">
                        <span><strong>I would feel a strong urge to buy the product.</strong></span>
                        <div class="scale-labels">
                            <span class="scale-label-left">Strongly Disagree</span>
                            <span class="scale-label-right">Strongly Agree</span>
                        </div>
                        <div class="scale-options">
                            <div class="scale-option-container">
                                <input type="radio" name="urge_buy" value="1">
                                <span class="scale-number">1</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="urge_buy" value="2">
                                <span class="scale-number">2</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="urge_buy" value="3">
                                <span class="scale-number">3</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="urge_buy" value="4">
                                <span class="scale-number">4</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="urge_buy" value="5">
                                <span class="scale-number">5</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="urge_buy" value="6">
                                <span class="scale-number">6</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="urge_buy" value="7">
                                <span class="scale-number">7</span>
                            </div>
                        </div>
                    </div>

                    <div class="scale-item">
                        <span><strong>I would want to purchase the product.</strong></span>
                        <div class="scale-labels">
                            <span class="scale-label-left">Strongly Disagree</span>
                            <span class="scale-label-right">Strongly Agree</span>
                        </div>
                        <div class="scale-options">
                            <div class="scale-option-container">
                                <input type="radio" name="want_purchase" value="1">
                                <span class="scale-number">1</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="want_purchase" value="2">
                                <span class="scale-number">2</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="want_purchase" value="3">
                                <span class="scale-number">3</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="want_purchase" value="4">
                                <span class="scale-number">4</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="want_purchase" value="5">
                                <span class="scale-number">5</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="want_purchase" value="6">
                                <span class="scale-number">6</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="want_purchase" value="7">
                                <span class="scale-number">7</span>
                            </div>
                        </div>
                    </div>

                    <div class="scale-item">
                        <span><strong>I would feel the impulse to buy the product.</strong></span>
                        <div class="scale-labels">
                            <span class="scale-label-left">Strongly Disagree</span>
                            <span class="scale-label-right">Strongly Agree</span>
                        </div>
                        <div class="scale-options">
                            <div class="scale-option-container">
                                <input type="radio" name="impulse_buy" value="1">
                                <span class="scale-number">1</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="impulse_buy" value="2">
                                <span class="scale-number">2</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="impulse_buy" value="3">
                                <span class="scale-number">3</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="impulse_buy" value="4">
                                <span class="scale-number">4</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="impulse_buy" value="5">
                                <span class="scale-number">5</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="impulse_buy" value="6">
                                <span class="scale-number">6</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="impulse_buy" value="7">
                                <span class="scale-number">7</span>
                            </div>
                        </div>
                    </div>

                    <div class="scale-item">
                        <span><strong>Please indicate the probability that you would buy the product.</strong></span>
                        <div class="scale-labels">
                            <span class="scale-label-left">Very Unlikely</span>
                            <span class="scale-label-right">Very Likely</span>
                        </div>
                        <div class="scale-options">
                            <div class="scale-option-container">
                                <input type="radio" name="probability_buy" value="1">
                                <span class="scale-number">1</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="probability_buy" value="2">
                                <span class="scale-number">2</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="probability_buy" value="3">
                                <span class="scale-number">3</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="probability_buy" value="4">
                                <span class="scale-number">4</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="probability_buy" value="5">
                                <span class="scale-number">5</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="probability_buy" value="6">
                                <span class="scale-number">6</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="probability_buy" value="7">
                                <span class="scale-number">7</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="goBack('scenario')">Back</button>
                    <button class="btn" id="submitBtn" onclick="validatePurchaseIntention()">Continue</button>
                </div>
            </div>

            <!-- Manipulation Check -->
            <div class="section" id="manipulation-check">
                <h2>Manipulation Check</h2>
                
                <div class="form-group">
                    <label><strong>How certain were you about what reward you would receive?</strong></label>
                    <p style="font-size: 14px; color: #666; margin-bottom: 15px;">
                        1 = very uncertain, meaning you do not know what you will get<br>
                        7 = very certain, meaning you know what you will get
                    </p>
                    <div class="scale-item">
                        <div class="scale-labels">
                            <span class="scale-label-left">Very Uncertain</span>
                            <span class="scale-label-right">Very Certain</span>
                        </div>
                        <div class="scale-options">
                            <div class="scale-option-container">
                                <input type="radio" name="certainty_scale" value="1">
                                <span class="scale-number">1</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="certainty_scale" value="2">
                                <span class="scale-number">2</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="certainty_scale" value="3">
                                <span class="scale-number">3</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="certainty_scale" value="4">
                                <span class="scale-number">4</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="certainty_scale" value="5">
                                <span class="scale-number">5</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="certainty_scale" value="6">
                                <span class="scale-number">6</span>
                            </div>
                            <div class="scale-option-container">
                                <input type="radio" name="certainty_scale" value="7">
                                <span class="scale-number">7</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label><strong>Which best describes the reward structure?</strong></label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="reward_knew" name="reward_structure" value="knew">
                            <label for="reward_knew">I knew exactly what I would get</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="reward_unsure" name="reward_structure" value="unsure">
                            <label for="reward_unsure">I was unsure what I would get</label>
                        </div>
                    </div>
                </div>
                
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="goBack('purchase-intention')">Back</button>
                    <button class="btn" onclick="validateManipulationCheck()">Submit Responses</button>
                </div>
            </div>

            <!-- Thank You Page -->
            <div class="section" id="thankyou">
                <div class="thank-you">
                    <h2>Thank You!</h2>
                    <p>Your participation in this research study is greatly appreciated.</p>
                    <p>Your responses have been recorded and will contribute valuable insights to our understanding of consumer purchase decisions.</p>
                    <p>If you have any questions about this study, please contact the researchers using the information provided in the consent form.</p>
                    <br>
                    <p><em>You may now close this browser window.</em></p>
                </div>
            </div>

            <!-- Ineligible Page -->
            <div class="section" id="ineligible">
                <div class="thank-you">
                    <h2>Thank You for Your Interest</h2>
                    <p>Unfortunately, you do not meet the eligibility criteria for this study.</p>
                    <p>We appreciate your willingness to participate in research.</p>
                    <br>
                    <p><em>You may now close this browser window.</em></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        const totalSteps = 7;
        let condition = null;
        let responses = {};

        // Your Google Apps Script URL - Current working URL
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwjE-0SmSrKLWDWwuPPhHcSdIDiKBjBbP4iah1adY5o7I5fduni0W-8vWdkifyjBxoaiQ/exec';

        // Scenarios for different conditions
        const scenarios = {
            uncertainty: {
                title: "Experimental Scenario",
                content: "Imagine the following situation:<br><br>You come across a Labubu 'Have A Seat' collectible priced at RM70. This is sold in a mystery box format, you can see the possible characters (as shown), but you won't know which specific one you'll receive until after purchase. Some versions are valued higher than others.",
                image: `
                    <div style="text-align: center; margin: 20px 0;">
                        <img src="https://imgur.com/yCSt9Bi.jpg" 
                             style="max-width: 100%; width: 400px; height: auto; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);"
                             alt="Labubu Have A Seat Mystery Box showing possible characters">
                        <div style="margin-top: 15px;">
                            <div style="font-size: 18px; color: #667eea; font-weight: bold;">🎁 Labubu 'Have A Seat' Mystery Box</div>
                            <div style="font-size: 14px; color: #666; margin: 5px 0;">Collectible series by Pop Mart - you'll receive one random character from the series</div>
                            <div style="font-size: 24px; color: #e74c3c; font-weight: bold;">RM 70</div>
                        </div>
                    </div>
                `
            },
            certainty: {
                title: "Experimental Scenario", 
                content: "Imagine the following situation:<br><br>You come across a Labubu 'Have A Seat' collectible priced at RM70. The product clearly shows the exact item you will receive - the BABA character from this series (as shown in the image). Labubu are popular collectible figures by Pop Mart featuring cute, rabbit-like characters that are very popular among young adults. You know exactly which specific character you will get.",
                image: `
                    <div style="text-align: center; margin: 20px 0;">
                        <img src="https://i.imgur.com/qfFB3Qw.jpeg" 
                             style="max-width: 100%; width: 250px; height: auto; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);"
                             alt="Labubu BABA character - brown rabbit-like figure">
                        <div style="margin-top: 15px;">
                            <div style="font-size: 18px; color: #667eea; font-weight: bold;">🐰 Labubu 'Have A Seat' - BABA Character</div>
                            <div style="font-size: 14px; color: #666; margin: 5px 0;">Specific character from the collectible series by Pop Mart</div>
                            <div style="font-size: 24px; color: #e74c3c; font-weight: bold;">RM 70</div>
                        </div>
                    </div>
                `
            }
        };

        function updateProgress() {
            const progress = (currentStep / totalSteps) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function goBack(sectionId) {
            // Hide current section
            document.querySelector('.section.active').classList.remove('active');
            
            // Show previous section
            document.getElementById(sectionId).classList.add('active');
            
            // Update step counter (go backwards)
            currentStep--;
            updateProgress();
        }

        function nextSection(sectionId) {
            // Hide current section
            document.querySelector('.section.active').classList.remove('active');
            
            // Show next section  
            document.getElementById(sectionId).classList.add('active');
            
            currentStep++;
            updateProgress();

            // Random assignment when moving to scenario
            if (sectionId === 'scenario' && condition === null) {
                // Equal randomization: 50% uncertainty, 50% certainty
                condition = Math.random() < 0.5 ? 'uncertainty' : 'certainty';
                responses.condition = condition;
                
                const scenario = scenarios[condition];
                document.getElementById('scenarioContent').innerHTML = `
                    <h3>${scenario.title}</h3>
                    <p>${scenario.content}</p>
                    ${scenario.image}
                `;
            }
        }

        function processConsent() {
            const consent = document.querySelector('input[name="consent"]:checked');
            if (!consent) {
                alert('Please select an option to continue.');
                return;
            }

            responses.consent = consent.value;

            if (consent.value === 'no') {
                // Save data for participants who declined consent
                responses.study_status = 'declined_consent';
                responses.timestamp = new Date().toISOString();
                
                // Submit data for participants who declined
                submitToGoogleSheets(responses).then(() => {
                    console.log('Declined consent participant data saved:', responses);
                }).catch(error => {
                    console.error('Error saving declined consent data:', error);
                });
                
                nextSection('thankyou');
                return;
            }

            nextSection('eligibility');
        }

        function checkEligibility() {
            const ageEligible = document.querySelector('input[name="age_eligible"]:checked');
            const englishProficiency = document.querySelector('input[name="english_proficiency"]:checked');

            if (!ageEligible || !englishProficiency) {
                alert('Please answer all eligibility questions.');
                return;
            }

            responses.age_eligible = ageEligible.value;
            responses.english_proficiency = englishProficiency.value;

            if (ageEligible.value === 'no' || englishProficiency.value === 'no') {
                // Save ineligible participant data
                responses.study_status = 'ineligible';
                responses.timestamp = new Date().toISOString();
                
                // Submit data for ineligible participants
                submitToGoogleSheets(responses).then(() => {
                    console.log('Ineligible participant data saved:', responses);
                }).catch(error => {
                    console.error('Error saving ineligible participant data:', error);
                });
                
                nextSection('ineligible');
                return;
            }

            responses.study_status = 'eligible';
            nextSection('demographics');
        }

        function validateDemographics() {
            const age = document.getElementById('age').value;
            const gender = document.getElementById('gender').value;
            const experience = document.querySelector('input[name="mystery_experience"]:checked');
            const frequency = document.querySelector('input[name="purchase_frequency"]:checked');

            if (!age || !gender || !experience || !frequency) {
                alert('Please fill in all demographic information.');
                return;
            }

            if (age < 18 || age > 29) {
                alert('Age must be between 18-29 years.');
                return;
            }

            responses.age = age;
            responses.gender = gender;
            responses.mystery_experience = experience.value;
            responses.purchase_frequency = frequency.value;

            nextSection('scenario');
        }

        function validatePurchaseIntention() {
            const urgeBuy = document.querySelector('input[name="urge_buy"]:checked');
            const wantPurchase = document.querySelector('input[name="want_purchase"]:checked');
            const impulseBuy = document.querySelector('input[name="impulse_buy"]:checked');
            const probabilityBuy = document.querySelector('input[name="probability_buy"]:checked');

            if (!urgeBuy || !wantPurchase || !impulseBuy || !probabilityBuy) {
                alert('Please answer all questions before continuing.');
                return;
            }

            responses.urge_buy = urgeBuy.value;
            responses.want_purchase = wantPurchase.value;
            responses.impulse_buy = impulseBuy.value;
            responses.probability_buy = probabilityBuy.value;

            nextSection('manipulation-check');
        }

        async function validateManipulationCheck() {
            const certaintyScale = document.querySelector('input[name="certainty_scale"]:checked');
            const rewardStructure = document.querySelector('input[name="reward_structure"]:checked');

            if (!certaintyScale || !rewardStructure) {
                alert('Please answer all manipulation check questions before submitting.');
                return;
            }

            responses.certainty_scale = certaintyScale.value;
            responses.reward_structure = rewardStructure.value;
            responses.study_status = 'completed';
            responses.timestamp = new Date().toISOString();

            // Show loading state
            const submitBtn = document.querySelector('#manipulation-check .btn:last-child');
            const originalText = submitBtn.innerHTML;
            submitBtn.disabled = true;
            submitBtn.innerHTML = 'Saving to Google Sheets...<div class="loading"></div>';

            try {
                // Send data to Google Sheets
                await submitToGoogleSheets(responses);
                console.log('Data successfully saved to Google Sheets:', responses);
                
                // Small delay to show success
                setTimeout(() => {
                    nextSection('thankyou');
                }, 1000);
                
            } catch (error) {
                console.error('Google Sheets submission error:', error);
                
                // Reset button
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalText;
                
                // Show user-friendly error message
                const retry = confirm('There was an issue saving your data to Google Sheets. Would you like to try again? Your responses have been saved locally as backup.');
                if (retry) {
                    validateManipulationCheck(); // Retry
                } else {
                    nextSection('thankyou'); // Proceed anyway
                }
            }
        }

        async function submitToGoogleSheets(data) {
            // Check if Google Apps Script URL is configured
            if (GOOGLE_SCRIPT_URL.includes('YOUR_ACTUAL_SCRIPT_ID_HERE')) {
                console.log('Google Sheets not configured. Data saved locally:', data);
                alert('Google Sheets URL not configured. Please update the GOOGLE_SCRIPT_URL variable with your deployed script URL.');
                return;
            }

            try {
                // Convert data to FormData for better compatibility
                const formData = new FormData();
                formData.append('timestamp', new Date().toISOString());
                formData.append('study_status', data.study_status || '');
                formData.append('condition', data.condition || '');
                formData.append('consent', data.consent || '');
                formData.append('age_eligible', data.age_eligible || '');
                formData.append('english_proficiency', data.english_proficiency || '');
                formData.append('age', data.age || '');
                formData.append('gender', data.gender || '');
                formData.append('mystery_experience', data.mystery_experience || '');
                formData.append('purchase_frequency', data.purchase_frequency || '');
                formData.append('certainty_scale', data.certainty_scale || '');
                formData.append('reward_structure', data.reward_structure || '');
                formData.append('urge_buy', data.urge_buy || '');
                formData.append('want_purchase', data.want_purchase || '');
                formData.append('impulse_buy', data.impulse_buy || '');
                formData.append('probability_buy', data.probability_buy || '');

                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    body: formData,
                    mode: 'no-cors' // This helps with CORS issues
                });

                // Note: With no-cors mode, we can't read the response
                // but the request should go through
                console.log('Data submitted to Google Sheets');
                return 'Success';

            } catch (error) {
                console.error('Submission error:', error);
                throw error;
            }
        }

        // Initialize progress bar
        updateProgress();

        /*
        ==========================================
        YOUR GOOGLE SHEETS IS READY! ✅
        ==========================================
        
        ✅ Google Sheets URL: https://docs.google.com/spreadsheets/d/1Q_OTo5whut1Sj9chIJjvTq_41PMN0xxQGFq_7Q_3wcA/edit?usp=sharing
        ✅ Spreadsheet ID: 1Q_OTo5whut1Sj9chIJjvTq_41PMN0xxQGFq_7Q_3wcA
        ✅ Google Apps Script URL: https://script.google.com/macros/s/AKfycbxtirdrH2IaY6qHmWA2yzq2narihN8t3_MG602S_MSQdiwYkWG7TYkc1AUAMRVIvM2GSg/exec
        
        MAKE SURE YOUR GOOGLE APPS SCRIPT CODE IS:
        
        function doPost(e) {
          try {
            // Your spreadsheet ID (already correct)
            const spreadsheetId = '1Q_OTo5whut1Sj9chIJjvTq_41PMN0xxQGFq_7Q_3wcA';
            const spreadsheet = SpreadsheetApp.openById(spreadsheetId);
            const sheet = spreadsheet.getActiveSheet();
            
            // Check if headers exist, if not add them
            if (sheet.getLastRow() === 0) {
              sheet.getRange(1, 1, 1, 17).setValues([[
                'Timestamp', 'Study_Status', 'Condition', 'Consent', 'Age_Eligible', 'English_Proficiency',
                'Age', 'Gender', 'Mystery_Experience', 'Purchase_Frequency', 'Certainty_Scale',
                'Reward_Structure', 'Urge_Buy', 'Want_Purchase', 'Impulse_Buy', 'Probability_Buy', 'Submission_Time'
              ]]);
            }
            
            const data = e.parameter;
            
            // Add participant data as new row
            sheet.appendRow([
              data.timestamp || new Date(),
              data.study_status || '',
              data.condition || '',
              data.consent || '',
              data.age_eligible || '',
              data.english_proficiency || '',
              data.age || '',
              data.gender || '',
              data.mystery_experience || '',
              data.purchase_frequency || '',
              data.certainty_scale || '',
              data.reward_structure || '',
              data.urge_buy || '',
              data.want_purchase || '',
              data.impulse_buy || '',
              data.probability_buy || '',
              new Date()
            ]);
            
            return ContentService
              .createTextOutput('Success')
              .setMimeType(ContentService.MimeType.TEXT);
            
          } catch (error) {
            return ContentService
              .createTextOutput('Error: ' + error.toString())
              .setMimeType(ContentService.MimeType.TEXT);
          }
        }

        function doGet(e) {
          return ContentService
            .createTextOutput('GET method not allowed')
            .setMimeType(ContentService.MimeType.TEXT);
        }
        
        ✅ YOUR SETUP IS COMPLETE!
        - Data will be saved to your Google Sheets
        - You can access it anytime with the URL above
        - Test the form to see data appear in real-time
        ==========================================
        */
    </script>
</body>
</html>
